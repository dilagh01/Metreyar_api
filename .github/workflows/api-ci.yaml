name: Create Project Structure

on:
  workflow_dispatch:       # اجرای دستی از تب Actions
  push:                    # اجرای خودکار روی هر push به main
    branches: [main]

jobs:
  create-structure:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Create backend directory structure
        run: |
          echo "Creating directory structure..."
          # Create main directories
          mkdir -p backend/app/api/v1
          mkdir -p backend/app/models
          mkdir -p backend/app/schemas
          mkdir -p backend/app/database
          mkdir -p backend/app/core
          mkdir -p backend/app/services
          mkdir -p backend/tests
          mkdir -p data/migrations
          mkdir -p scripts
          mkdir -p docs

          # Create __init__.py files
          for dir in backend backend/app backend/app/api backend/app/api/v1 \
                   backend/app/models backend/app/schemas backend/app/database \
                   backend/app/core backend/app/services backend/tests; do
            touch "$dir/__init__.py"
          done

          echo "✅ Directory structure created successfully"
          echo ""
          echo "📂 Project structure:"
          find backend -type d | sort

      - name: Verify structure
        run: |
          echo "Verifying directory structure..."
          if [ -d "backend/app/api/v1" ] && [ -d "backend/app/models" ] && [ -d "backend/app/database" ]; then
            echo "✅ Directory structure verified successfully"
          else
            echo "❌ Directory structure verification failed"
            exit 1
          fi
